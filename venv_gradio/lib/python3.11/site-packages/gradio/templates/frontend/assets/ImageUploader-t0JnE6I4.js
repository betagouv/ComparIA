import"./IconButtonWrapper.svelte_svelte_type_style_lang-Bcv5C2d8.js";import"./MarkdownCode.svelte_svelte_type_style_lang-BJzlDKLo.js";import{B as ut}from"./BlockLabel-DblqP5Sf.js";import{I as _t}from"./IconButton-BgomsPvt.js";import{C as ft}from"./Clear-By3xiIwg.js";import{I as mt,F as dt}from"./FullscreenButton-DJD7PAuK.js";import{W as gt,a as ht,S as pt}from"./SelectSource-BQcTuzA5.js";import{I as bt}from"./IconButtonWrapper-BPnBuW_R.js";import{g as wt}from"./utils-Gtzs_Zla.js";import{D as rt}from"./DropdownArrow-Cz8zw9hm.js";import{S as vt}from"./Square-oAGqOwsh.js";import"./StreamingBar.svelte_svelte_type_style_lang-CDNxkBIr.js";import{f as kt}from"./index-CwtUPKf4.js";import{S as yt}from"./StreamingBar-BU9S4hA7.js";import{f as It}from"./index-BAPxzJ9I.js";import{a as zt}from"./Upload-CeuP3WiG.js";import"./DownloadLink.svelte_svelte_type_style_lang-C_5UIfol.js";import{I as Ct}from"./Image-CnqB5dbD.js";const{SvelteComponent:St,append:Ve,attr:H,detach:Dt,init:qt,insert:$t,noop:Te,safe_not_equal:Et,svg_element:je}=window.__gradio__svelte__internal;function Wt(l){let e,t,n;return{c(){e=je("svg"),t=je("path"),n=je("circle"),H(t,"d","M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"),H(n,"cx","12"),H(n,"cy","13"),H(n,"r","4"),H(e,"xmlns","http://www.w3.org/2000/svg"),H(e,"width","100%"),H(e,"height","100%"),H(e,"viewBox","0 0 24 24"),H(e,"fill","none"),H(e,"stroke","currentColor"),H(e,"stroke-width","1.5"),H(e,"stroke-linecap","round"),H(e,"stroke-linejoin","round"),H(e,"class","feather feather-camera")},m(i,s){$t(i,e,s),Ve(e,t),Ve(e,n)},p:Te,i:Te,o:Te,d(i){i&&Dt(e)}}}class Bt extends St{constructor(e){super(),qt(this,e,null,Wt,Et,{})}}const{SvelteComponent:Mt,append:Rt,attr:P,detach:Tt,init:jt,insert:Nt,noop:Ne,safe_not_equal:Ut,svg_element:Ge}=window.__gradio__svelte__internal;function Lt(l){let e,t;return{c(){e=Ge("svg"),t=Ge("circle"),P(t,"cx","12"),P(t,"cy","12"),P(t,"r","10"),P(e,"xmlns","http://www.w3.org/2000/svg"),P(e,"width","100%"),P(e,"height","100%"),P(e,"viewBox","0 0 24 24"),P(e,"stroke-width","1.5"),P(e,"stroke-linecap","round"),P(e,"stroke-linejoin","round"),P(e,"class","feather feather-circle")},m(n,i){Nt(n,e,i),Rt(e,t)},p:Ne,i:Ne,o:Ne,d(n){n&&Tt(e)}}}class Ft extends Mt{constructor(e){super(),jt(this,e,null,Lt,Ut,{})}}const{SvelteComponent:At,append:ve,attr:Ue,create_component:Ht,destroy_component:Ot,detach:Pt,element:Le,init:Vt,insert:Gt,listen:Jt,mount_component:Kt,noop:Qt,safe_not_equal:Xt,set_style:Yt,space:Zt,text:xt,transition_in:en,transition_out:tn}=window.__gradio__svelte__internal,{createEventDispatcher:nn}=window.__gradio__svelte__internal;function ln(l){let e,t,n,i,s,r="Click to Access Webcam",c,o,u,f;return i=new gt({}),{c(){e=Le("button"),t=Le("div"),n=Le("span"),Ht(i.$$.fragment),s=Zt(),c=xt(r),Ue(n,"class","icon-wrap svelte-qbrfs"),Ue(t,"class","wrap svelte-qbrfs"),Ue(e,"class","svelte-qbrfs"),Yt(e,"height","100%")},m(_,w){Gt(_,e,w),ve(e,t),ve(t,n),Kt(i,n,null),ve(t,s),ve(t,c),o=!0,u||(f=Jt(e,"click",l[1]),u=!0)},p:Qt,i(_){o||(en(i.$$.fragment,_),o=!0)},o(_){tn(i.$$.fragment,_),o=!1},d(_){_&&Pt(e),Ot(i),u=!1,f()}}}function rn(l){const e=nn();return[e,()=>e("click")]}class sn extends At{constructor(e){super(),Vt(this,e,rn,ln,Xt,{})}}function on(){return navigator.mediaDevices.enumerateDevices()}function an(l,e){e.srcObject=l,e.muted=!0,e.play()}async function Je(l,e,t,n){const i={video:n?{deviceId:{exact:n},...t?.video}:t?.video||{width:{ideal:1920},height:{ideal:1440}},audio:l&&(t?.audio??!0)};return navigator.mediaDevices.getUserMedia(i).then(s=>(an(s,e),s))}function cn(l){return l.filter(t=>t.kind==="videoinput")}const{SvelteComponent:un,action_destroyer:_n,add_render_callback:fn,append:C,attr:y,binding_callbacks:mn,check_outros:fe,create_component:Z,create_in_transition:dn,destroy_component:x,destroy_each:gn,detach:U,element:B,empty:He,ensure_array_like:Ke,flush:V,group_outros:me,init:hn,insert:L,listen:ze,mount_component:ee,noop:Oe,run_all:pn,safe_not_equal:bn,set_data:be,set_input_value:Fe,set_style:st,space:K,src_url_equal:Qe,stop_propagation:wn,text:we,toggle_class:re,transition_in:D,transition_out:W}=window.__gradio__svelte__internal,{createEventDispatcher:vn,onDestroy:kn,onMount:yn}=window.__gradio__svelte__internal;function Xe(l,e,t){const n=l.slice();return n[39]=e[t],n}function In(l){let e,t,n,i,s,r,c,o,u,f,_;const w=[Sn,Cn],I=[];function R(b,k){return b[2]==="video"||b[1]?0:1}n=R(l),i=I[n]=w[n](l);let g=!l[11]&&Ye(l),p=l[13]&&l[8]&&Ze(l);return{c(){e=B("div"),t=B("button"),i.c(),r=K(),g&&g.c(),c=K(),p&&p.c(),o=He(),y(t,"aria-label",s=l[2]==="image"?"capture photo":"start recording"),y(t,"class","svelte-10cpz3p"),y(e,"class","button-wrap svelte-10cpz3p")},m(b,k){L(b,e,k),C(e,t),I[n].m(t,null),C(e,r),g&&g.m(e,null),L(b,c,k),p&&p.m(b,k),L(b,o,k),u=!0,f||(_=ze(t,"click",l[28]),f=!0)},p(b,k){let F=n;n=R(b),n===F?I[n].p(b,k):(me(),W(I[F],1,1,()=>{I[F]=null}),fe(),i=I[n],i?i.p(b,k):(i=I[n]=w[n](b),i.c()),D(i,1),i.m(t,null)),(!u||k[0]&4&&s!==(s=b[2]==="image"?"capture photo":"start recording"))&&y(t,"aria-label",s),b[11]?g&&(me(),W(g,1,1,()=>{g=null}),fe()):g?(g.p(b,k),k[0]&2048&&D(g,1)):(g=Ye(b),g.c(),D(g,1),g.m(e,null)),b[13]&&b[8]?p?(p.p(b,k),k[0]&8448&&D(p,1)):(p=Ze(b),p.c(),D(p,1),p.m(o.parentNode,o)):p&&(me(),W(p,1,1,()=>{p=null}),fe())},i(b){u||(D(i),D(g),D(p),u=!0)},o(b){W(i),W(g),W(p),u=!1},d(b){b&&(U(e),U(c),U(o)),I[n].d(),g&&g.d(),p&&p.d(b),f=!1,_()}}}function zn(l){let e,t,n,i;return t=new sn({}),t.$on("click",l[27]),{c(){e=B("div"),Z(t.$$.fragment),y(e,"title","grant webcam access"),st(e,"height","100%")},m(s,r){L(s,e,r),ee(t,e,null),i=!0},p:Oe,i(s){i||(D(t.$$.fragment,s),s&&(n||fn(()=>{n=dn(e,kt,{delay:100,duration:200}),n.start()})),i=!0)},o(s){W(t.$$.fragment,s),i=!1},d(s){s&&U(e),x(t)}}}function Cn(l){let e,t,n;return t=new Bt({}),{c(){e=B("div"),Z(t.$$.fragment),y(e,"class","icon svelte-10cpz3p"),y(e,"title","capture photo")},m(i,s){L(i,e,s),ee(t,e,null),n=!0},p:Oe,i(i){n||(D(t.$$.fragment,i),n=!0)},o(i){W(t.$$.fragment,i),n=!1},d(i){i&&U(e),x(t)}}}function Sn(l){let e,t,n,i;const s=[$n,qn,Dn],r=[];function c(o,u){return o[1]&&o[10]==="waiting"?0:o[1]&&o[10]==="open"||!o[1]&&o[11]?1:2}return e=c(l),t=r[e]=s[e](l),{c(){t.c(),n=He()},m(o,u){r[e].m(o,u),L(o,n,u),i=!0},p(o,u){let f=e;e=c(o),e===f?r[e].p(o,u):(me(),W(r[f],1,1,()=>{r[f]=null}),fe(),t=r[e],t?t.p(o,u):(t=r[e]=s[e](o),t.c()),D(t,1),t.m(n.parentNode,n))},i(o){i||(D(t),i=!0)},o(o){W(t),i=!1},d(o){o&&U(n),r[e].d(o)}}}function Dn(l){let e,t,n,i,s=l[4]("audio.record")+"",r,c;return n=new Ft({}),{c(){e=B("div"),t=B("div"),Z(n.$$.fragment),i=K(),r=we(s),y(t,"class","icon color-primary svelte-10cpz3p"),y(t,"title","start recording"),y(e,"class","icon-with-text svelte-10cpz3p")},m(o,u){L(o,e,u),C(e,t),ee(n,t,null),C(e,i),C(e,r),c=!0},p(o,u){(!c||u[0]&16)&&s!==(s=o[4]("audio.record")+"")&&be(r,s)},i(o){c||(D(n.$$.fragment,o),c=!0)},o(o){W(n.$$.fragment,o),c=!1},d(o){o&&U(e),x(n)}}}function qn(l){let e,t,n,i,s=l[4]("audio.stop")+"",r,c;return n=new vt({}),{c(){e=B("div"),t=B("div"),Z(n.$$.fragment),i=K(),r=we(s),y(t,"class","icon color-primary svelte-10cpz3p"),y(t,"title","stop recording"),y(e,"class","icon-with-text svelte-10cpz3p")},m(o,u){L(o,e,u),C(e,t),ee(n,t,null),C(e,i),C(e,r),c=!0},p(o,u){(!c||u[0]&16)&&s!==(s=o[4]("audio.stop")+"")&&be(r,s)},i(o){c||(D(n.$$.fragment,o),c=!0)},o(o){W(n.$$.fragment,o),c=!1},d(o){o&&U(e),x(n)}}}function $n(l){let e,t,n,i,s=l[4]("audio.waiting")+"",r,c;return n=new ht({}),{c(){e=B("div"),t=B("div"),Z(n.$$.fragment),i=K(),r=we(s),y(t,"class","icon color-primary svelte-10cpz3p"),y(t,"title","spinner"),y(e,"class","icon-with-text svelte-10cpz3p"),st(e,"width","var(--size-24)")},m(o,u){L(o,e,u),C(e,t),ee(n,t,null),C(e,i),C(e,r),c=!0},p(o,u){(!c||u[0]&16)&&s!==(s=o[4]("audio.waiting")+"")&&be(r,s)},i(o){c||(D(n.$$.fragment,o),c=!0)},o(o){W(n.$$.fragment,o),c=!1},d(o){o&&U(e),x(n)}}}function Ye(l){let e,t,n,i,s;return t=new rt({}),{c(){e=B("button"),Z(t.$$.fragment),y(e,"class","icon svelte-10cpz3p"),y(e,"aria-label","select input source")},m(r,c){L(r,e,c),ee(t,e,null),n=!0,i||(s=ze(e,"click",l[29]),i=!0)},p:Oe,i(r){n||(D(t.$$.fragment,r),n=!0)},o(r){W(t.$$.fragment,r),n=!1},d(r){r&&U(e),x(t),i=!1,s()}}}function Ze(l){let e,t,n,i,s,r,c;n=new rt({});function o(_,w){return _[7].length===0?Wn:En}let u=o(l),f=u(l);return{c(){e=B("select"),t=B("button"),Z(n.$$.fragment),i=K(),f.c(),y(t,"class","inset-icon svelte-10cpz3p"),y(e,"class","select-wrap svelte-10cpz3p"),y(e,"aria-label","select source")},m(_,w){L(_,e,w),C(e,t),ee(n,t,null),C(t,i),f.m(e,null),s=!0,r||(c=[ze(t,"click",wn(l[30])),_n(Pe.call(null,e,l[17])),ze(e,"change",l[14])],r=!0)},p(_,w){u===(u=o(_))&&f?f.p(_,w):(f.d(1),f=u(_),f&&(f.c(),f.m(e,null)))},i(_){s||(D(n.$$.fragment,_),s=!0)},o(_){W(n.$$.fragment,_),s=!1},d(_){_&&U(e),x(n),f.d(),r=!1,pn(c)}}}function En(l){let e,t=Ke(l[7]),n=[];for(let i=0;i<t.length;i+=1)n[i]=xe(Xe(l,t,i));return{c(){for(let i=0;i<n.length;i+=1)n[i].c();e=He()},m(i,s){for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(i,s);L(i,e,s)},p(i,s){if(s[0]&384){t=Ke(i[7]);let r;for(r=0;r<t.length;r+=1){const c=Xe(i,t,r);n[r]?n[r].p(c,s):(n[r]=xe(c),n[r].c(),n[r].m(e.parentNode,e))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(i){i&&U(e),gn(n,i)}}}function Wn(l){let e,t=l[4]("common.no_devices")+"",n;return{c(){e=B("option"),n=we(t),e.__value="",Fe(e,e.__value),y(e,"class","svelte-10cpz3p")},m(i,s){L(i,e,s),C(e,n)},p(i,s){s[0]&16&&t!==(t=i[4]("common.no_devices")+"")&&be(n,t)},d(i){i&&U(e)}}}function xe(l){let e,t=l[39].label+"",n,i,s,r;return{c(){e=B("option"),n=we(t),i=K(),e.__value=s=l[39].deviceId,Fe(e,e.__value),e.selected=r=l[8].deviceId===l[39].deviceId,y(e,"class","svelte-10cpz3p")},m(c,o){L(c,e,o),C(e,n),C(e,i)},p(c,o){o[0]&128&&t!==(t=c[39].label+"")&&be(n,t),o[0]&128&&s!==(s=c[39].deviceId)&&(e.__value=s,Fe(e,e.__value)),o[0]&384&&r!==(r=c[8].deviceId===c[39].deviceId)&&(e.selected=r)},d(c){c&&U(e)}}}function Bn(l){let e,t,n,i,s,r,c,o,u,f,_;t=new yt({props:{time_limit:l[9]}});const w=[zn,In],I=[];function R(g,p){return g[12]?1:0}return u=R(l),f=I[u]=w[u](l),{c(){e=B("div"),Z(t.$$.fragment),n=K(),i=B("video"),s=K(),r=B("img"),o=K(),f.c(),y(i,"class","svelte-10cpz3p"),re(i,"flip",l[3]),re(i,"hide",!l[12]||l[12]&&!!l[0]),Qe(r.src,c=l[0]?.url)||y(r,"src",c),y(r,"class","svelte-10cpz3p"),re(r,"hide",!l[12]||l[12]&&!l[0]),y(e,"class","wrap svelte-10cpz3p")},m(g,p){L(g,e,p),ee(t,e,null),C(e,n),C(e,i),l[26](i),C(e,s),C(e,r),C(e,o),I[u].m(e,null),_=!0},p(g,p){const b={};p[0]&512&&(b.time_limit=g[9]),t.$set(b),(!_||p[0]&8)&&re(i,"flip",g[3]),(!_||p[0]&4097)&&re(i,"hide",!g[12]||g[12]&&!!g[0]),(!_||p[0]&1&&!Qe(r.src,c=g[0]?.url))&&y(r,"src",c),(!_||p[0]&4097)&&re(r,"hide",!g[12]||g[12]&&!g[0]);let k=u;u=R(g),u===k?I[u].p(g,p):(me(),W(I[k],1,1,()=>{I[k]=null}),fe(),f=I[u],f?f.p(g,p):(f=I[u]=w[u](g),f.c()),D(f,1),f.m(e,null))},i(g){_||(D(t.$$.fragment,g),D(f),_=!0)},o(g){W(t.$$.fragment,g),W(f),_=!1},d(g){g&&U(e),x(t),l[26](null),I[u].d()}}}function Pe(l,e){const t=n=>{l&&!l.contains(n.target)&&!n.defaultPrevented&&e(n)};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}}function Mn(l,e,t){let n,i=[],s=null,r=null,c="closed";const o=d=>{d==="closed"?(t(9,r=null),t(10,c="closed"),t(0,O=null)):d==="waiting"?t(10,c="waiting"):t(10,c="open")},u=d=>{j&&t(9,r=d)};let f,{streaming:_=!1}=e,{pending:w=!1}=e,{root:I=""}=e,{stream_every:R=1}=e,{mode:g="image"}=e,{mirror_webcam:p}=e,{include_audio:b}=e,{webcam_constraints:k=null}=e,{i18n:F}=e,{upload:M}=e,{value:O=null}=e;const v=vn();yn(()=>{f=document.createElement("canvas"),_&&g==="image"&&window.setInterval(()=>{n&&!w&&A()},R*1e3)});const m=async d=>{const J=d.target.value;await Je(b,n,k,J).then(async ce=>{T=ce,t(8,s=i.find(ue=>ue.deviceId===J)||null),t(13,ne=!1)})};async function h(){try{Je(b,n,k).then(async d=>{t(12,ae=!0),t(7,i=await on()),T=d}).then(()=>cn(i)).then(d=>{t(7,i=d);const q=T.getTracks().map(J=>J.getSettings()?.deviceId)[0];t(8,s=q&&d.find(J=>J.deviceId===q)||i[0])}),(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)&&v("error",F("image.no_webcam_support"))}catch(d){if(d instanceof DOMException&&d.name=="NotAllowedError")v("error",F("image.allow_webcam_access"));else throw d}}function A(){var d=f.getContext("2d");if((!_||_&&j)&&n.videoWidth&&n.videoHeight){if(f.width=n.videoWidth,f.height=n.videoHeight,d.drawImage(n,0,0,n.videoWidth,n.videoHeight),p&&(d.scale(-1,1),d.drawImage(n,-n.videoWidth,0)),_&&(!j||c==="waiting"))return;if(_){const q=f.toDataURL("image/jpeg");v("stream",q);return}f.toBlob(q=>{v(_?"stream":"capture",q)},`image/${_?"jpeg":"png"}`,.8)}}let j=!1,E=[],T,N,G;function Se(){if(j){G.stop();let d=new Blob(E,{type:N}),q=new FileReader;q.onload=async function(J){if(J.target){let ce=new File([d],"sample."+N.substring(6));const ue=await It([ce]);let Me=(await M(ue,I))?.filter(Boolean)[0];v("capture",Me),v("stop_recording")}},q.readAsDataURL(d)}else if(typeof MediaRecorder<"u"){v("start_recording"),E=[];let d=["video/webm","video/mp4"];for(let q of d)if(MediaRecorder.isTypeSupported(q)){N=q;break}if(N===null){console.error("No supported MediaRecorder mimeType");return}G=new MediaRecorder(T,{mimeType:N}),G.addEventListener("dataavailable",function(q){E.push(q.data)}),G.start(200)}t(11,j=!j)}let ae=!1;function te({destroy:d}={}){g==="image"&&_&&t(11,j=!j),d||(g==="image"?A():Se()),!j&&T&&(v("close_stream"),T.getTracks().forEach(q=>q.stop()),t(6,n.srcObject=null,n),t(12,ae=!1),window.setTimeout(()=>{t(0,O=null)},500),t(0,O=null))}let ne=!1;function De(d){d.preventDefault(),d.stopPropagation(),t(13,ne=!1)}kn(()=>{typeof window>"u"||(te({destroy:!0}),T?.getTracks().forEach(d=>d.stop()))});function qe(d){mn[d?"unshift":"push"](()=>{n=d,t(6,n)})}const $e=async()=>h(),Ee=()=>te(),We=()=>t(13,ne=!0),Be=()=>t(13,ne=!1);return l.$$set=d=>{"streaming"in d&&t(1,_=d.streaming),"pending"in d&&t(20,w=d.pending),"root"in d&&t(21,I=d.root),"stream_every"in d&&t(22,R=d.stream_every),"mode"in d&&t(2,g=d.mode),"mirror_webcam"in d&&t(3,p=d.mirror_webcam),"include_audio"in d&&t(23,b=d.include_audio),"webcam_constraints"in d&&t(24,k=d.webcam_constraints),"i18n"in d&&t(4,F=d.i18n),"upload"in d&&t(25,M=d.upload),"value"in d&&t(0,O=d.value)},[O,_,g,p,F,Pe,n,i,s,r,c,j,ae,ne,m,h,te,De,o,u,w,I,R,b,k,M,qe,$e,Ee,We,Be]}class Rn extends un{constructor(e){super(),hn(this,e,Mn,Bn,bn,{modify_stream:18,set_time_limit:19,streaming:1,pending:20,root:21,stream_every:22,mode:2,mirror_webcam:3,include_audio:23,webcam_constraints:24,i18n:4,upload:25,value:0,click_outside:5},null,[-1,-1])}get modify_stream(){return this.$$.ctx[18]}get set_time_limit(){return this.$$.ctx[19]}get streaming(){return this.$$.ctx[1]}set streaming(e){this.$$set({streaming:e}),V()}get pending(){return this.$$.ctx[20]}set pending(e){this.$$set({pending:e}),V()}get root(){return this.$$.ctx[21]}set root(e){this.$$set({root:e}),V()}get stream_every(){return this.$$.ctx[22]}set stream_every(e){this.$$set({stream_every:e}),V()}get mode(){return this.$$.ctx[2]}set mode(e){this.$$set({mode:e}),V()}get mirror_webcam(){return this.$$.ctx[3]}set mirror_webcam(e){this.$$set({mirror_webcam:e}),V()}get include_audio(){return this.$$.ctx[23]}set include_audio(e){this.$$set({include_audio:e}),V()}get webcam_constraints(){return this.$$.ctx[24]}set webcam_constraints(e){this.$$set({webcam_constraints:e}),V()}get i18n(){return this.$$.ctx[4]}set i18n(e){this.$$set({i18n:e}),V()}get upload(){return this.$$.ctx[25]}set upload(e){this.$$set({upload:e}),V()}get value(){return this.$$.ctx[0]}set value(e){this.$$set({value:e}),V()}get click_outside(){return Pe}}const Tn=Rn,{SvelteComponent:jn,add_flush_callback:de,append:ke,attr:Ie,bind:ge,binding_callbacks:le,bubble:ye,check_outros:he,create_component:Q,create_slot:Nn,destroy_component:X,detach:se,element:Ae,empty:ot,flush:S,get_all_dirty_from_scope:Un,get_slot_changes:Ln,group_outros:pe,init:Fn,insert:oe,listen:An,mount_component:Y,safe_not_equal:Hn,set_style:et,space:_e,toggle_class:Ce,transition_in:z,transition_out:$,update_slot_base:On}=window.__gradio__svelte__internal,{createEventDispatcher:Pn,tick:Vn}=window.__gradio__svelte__internal;function tt(l){let e,t,n,i=l[18]&&nt(l);return t=new _t({props:{Icon:ft,label:"Remove Image"}}),t.$on("click",l[30]),{c(){i&&i.c(),e=_e(),Q(t.$$.fragment)},m(s,r){i&&i.m(s,r),oe(s,e,r),Y(t,s,r),n=!0},p(s,r){s[18]?i?(i.p(s,r),r[0]&262144&&z(i,1)):(i=nt(s),i.c(),z(i,1),i.m(e.parentNode,e)):i&&(pe(),$(i,1,1,()=>{i=null}),he())},i(s){n||(z(i),z(t.$$.fragment,s),n=!0)},o(s){$(i),$(t.$$.fragment,s),n=!1},d(s){s&&se(e),i&&i.d(s),X(t,s)}}}function nt(l){let e,t;return e=new dt({props:{container:l[21]}}),{c(){Q(e.$$.fragment)},m(n,i){Y(e,n,i),t=!0},p(n,i){const s={};i[0]&2097152&&(s.container=n[21]),e.$set(s)},i(n){t||(z(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){X(e,n)}}}function Gn(l){let e,t,n=l[3]?.url&&!l[19]&&tt(l);return{c(){n&&n.c(),e=ot()},m(i,s){n&&n.m(i,s),oe(i,e,s),t=!0},p(i,s){i[3]?.url&&!i[19]?n?(n.p(i,s),s[0]&524296&&z(n,1)):(n=tt(i),n.c(),z(n,1),n.m(e.parentNode,e)):n&&(pe(),$(n,1,1,()=>{n=null}),he())},i(i){t||(z(n),t=!0)},o(i){$(n),t=!1},d(i){i&&se(e),n&&n.d(i)}}}function it(l){let e;const t=l[29].default,n=Nn(t,l,l[45],null);return{c(){n&&n.c()},m(i,s){n&&n.m(i,s),e=!0},p(i,s){n&&n.p&&(!e||s[1]&16384)&&On(n,t,i,i[45],e?Ln(t,i[45],s,null):Un(i[45]),null)},i(i){e||(z(n,i),e=!0)},o(i){$(n,i),e=!1},d(i){n&&n.d(i)}}}function Jn(l){let e,t,n=l[3]===null&&it(l);return{c(){n&&n.c(),e=ot()},m(i,s){n&&n.m(i,s),oe(i,e,s),t=!0},p(i,s){i[3]===null?n?(n.p(i,s),s[0]&8&&z(n,1)):(n=it(i),n.c(),z(n,1),n.m(e.parentNode,e)):n&&(pe(),$(n,1,1,()=>{n=null}),he())},i(i){t||(z(n),t=!0)},o(i){$(n),t=!1},d(i){i&&se(e),n&&n.d(i)}}}function Kn(l){let e,t,n,i,s;return t=new Ct({props:{src:l[3].url,alt:l[3].alt_text}}),{c(){e=Ae("div"),Q(t.$$.fragment),Ie(e,"class","image-frame svelte-11chud3"),Ce(e,"selectable",l[11])},m(r,c){oe(r,e,c),Y(t,e,null),n=!0,i||(s=An(e,"click",l[26]),i=!0)},p(r,c){const o={};c[0]&8&&(o.src=r[3].url),c[0]&8&&(o.alt=r[3].alt_text),t.$set(o),(!n||c[0]&2048)&&Ce(e,"selectable",r[11])},i(r){n||(z(t.$$.fragment,r),n=!0)},o(r){$(t.$$.fragment,r),n=!1},d(r){r&&se(e),X(t),i=!1,s()}}}function Qn(l){let e,t,n,i;function s(o){l[35](o)}function r(o){l[36](o)}let c={root:l[12],value:l[3],mirror_webcam:l[10].mirror,stream_every:l[17],streaming:l[9],mode:"image",include_audio:!1,i18n:l[13],upload:l[15],webcam_constraints:l[10].constraints};return l[4]!==void 0&&(c.modify_stream=l[4]),l[5]!==void 0&&(c.set_time_limit=l[5]),e=new Tn({props:c}),le.push(()=>ge(e,"modify_stream",s)),le.push(()=>ge(e,"set_time_limit",r)),e.$on("capture",l[37]),e.$on("stream",l[38]),e.$on("error",l[39]),e.$on("drag",l[40]),e.$on("upload",l[41]),e.$on("close_stream",l[42]),{c(){Q(e.$$.fragment)},m(o,u){Y(e,o,u),i=!0},p(o,u){const f={};u[0]&4096&&(f.root=o[12]),u[0]&8&&(f.value=o[3]),u[0]&1024&&(f.mirror_webcam=o[10].mirror),u[0]&131072&&(f.stream_every=o[17]),u[0]&512&&(f.streaming=o[9]),u[0]&8192&&(f.i18n=o[13]),u[0]&32768&&(f.upload=o[15]),u[0]&1024&&(f.webcam_constraints=o[10].constraints),!t&&u[0]&16&&(t=!0,f.modify_stream=o[4],de(()=>t=!1)),!n&&u[0]&32&&(n=!0,f.set_time_limit=o[5],de(()=>n=!1)),e.$set(f)},i(o){i||(z(e.$$.fragment,o),i=!0)},o(o){$(e.$$.fragment,o),i=!1},d(o){X(e,o)}}}function lt(l){let e,t,n;function i(r){l[43](r)}let s={sources:l[8],handle_clear:l[23],handle_select:l[27]};return l[1]!==void 0&&(s.active_source=l[1]),e=new pt({props:s}),le.push(()=>ge(e,"active_source",i)),{c(){Q(e.$$.fragment)},m(r,c){Y(e,r,c),n=!0},p(r,c){const o={};c[0]&256&&(o.sources=r[8]),!t&&c[0]&2&&(t=!0,o.active_source=r[1],de(()=>t=!1)),e.$set(o)},i(r){n||(z(e.$$.fragment,r),n=!0)},o(r){$(e.$$.fragment,r),n=!1},d(r){X(e,r)}}}function Xn(l){let e,t,n,i,s,r,c,o,u,f,_,w,I,R=l[8].length>1||l[8].includes("clipboard"),g;e=new ut({props:{show_label:l[7],Icon:mt,label:l[6]||"Image"}}),i=new bt({props:{$$slots:{default:[Gn]},$$scope:{ctx:l}}});function p(m){l[32](m)}function b(m){l[33](m)}let k={hidden:l[3]!==null||l[1]==="webcam",filetype:l[1]==="clipboard"?"clipboard":"image/*",root:l[12],max_file_size:l[14],disable_click:!l[8].includes("upload")||l[3]!==null,upload:l[15],stream_handler:l[16],aria_label:l[13]("image.drop_to_upload"),$$slots:{default:[Jn]},$$scope:{ctx:l}};l[0]!==void 0&&(k.uploading=l[0]),l[2]!==void 0&&(k.dragging=l[2]),c=new zt({props:k}),l[31](c),le.push(()=>ge(c,"uploading",p)),le.push(()=>ge(c,"dragging",b)),c.$on("load",l[22]),c.$on("error",l[34]);const F=[Qn,Kn],M=[];function O(m,h){return m[1]==="webcam"&&(m[9]||!m[9]&&!m[3])?0:m[3]!==null&&!m[9]?1:-1}~(_=O(l))&&(w=M[_]=F[_](l));let v=R&&lt(l);return{c(){Q(e.$$.fragment),t=_e(),n=Ae("div"),Q(i.$$.fragment),s=_e(),r=Ae("div"),Q(c.$$.fragment),f=_e(),w&&w.c(),I=_e(),v&&v.c(),Ie(r,"class","upload-container svelte-11chud3"),Ce(r,"reduced-height",l[8].length>1),et(r,"width",l[3]?"auto":"100%"),Ie(n,"data-testid","image"),Ie(n,"class","image-container svelte-11chud3")},m(m,h){Y(e,m,h),oe(m,t,h),oe(m,n,h),Y(i,n,null),ke(n,s),ke(n,r),Y(c,r,null),ke(r,f),~_&&M[_].m(r,null),ke(n,I),v&&v.m(n,null),l[44](n),g=!0},p(m,h){const A={};h[0]&128&&(A.show_label=m[7]),h[0]&64&&(A.label=m[6]||"Image"),e.$set(A);const j={};h[0]&2883592|h[1]&16384&&(j.$$scope={dirty:h,ctx:m}),i.$set(j);const E={};h[0]&10&&(E.hidden=m[3]!==null||m[1]==="webcam"),h[0]&2&&(E.filetype=m[1]==="clipboard"?"clipboard":"image/*"),h[0]&4096&&(E.root=m[12]),h[0]&16384&&(E.max_file_size=m[14]),h[0]&264&&(E.disable_click=!m[8].includes("upload")||m[3]!==null),h[0]&32768&&(E.upload=m[15]),h[0]&65536&&(E.stream_handler=m[16]),h[0]&8192&&(E.aria_label=m[13]("image.drop_to_upload")),h[0]&8|h[1]&16384&&(E.$$scope={dirty:h,ctx:m}),!o&&h[0]&1&&(o=!0,E.uploading=m[0],de(()=>o=!1)),!u&&h[0]&4&&(u=!0,E.dragging=m[2],de(()=>u=!1)),c.$set(E);let T=_;_=O(m),_===T?~_&&M[_].p(m,h):(w&&(pe(),$(M[T],1,1,()=>{M[T]=null}),he()),~_?(w=M[_],w?w.p(m,h):(w=M[_]=F[_](m),w.c()),z(w,1),w.m(r,null)):w=null),(!g||h[0]&256)&&Ce(r,"reduced-height",m[8].length>1),h[0]&8&&et(r,"width",m[3]?"auto":"100%"),h[0]&256&&(R=m[8].length>1||m[8].includes("clipboard")),R?v?(v.p(m,h),h[0]&256&&z(v,1)):(v=lt(m),v.c(),z(v,1),v.m(n,null)):v&&(pe(),$(v,1,1,()=>{v=null}),he())},i(m){g||(z(e.$$.fragment,m),z(i.$$.fragment,m),z(c.$$.fragment,m),z(w),z(v),g=!0)},o(m){$(e.$$.fragment,m),$(i.$$.fragment,m),$(c.$$.fragment,m),$(w),$(v),g=!1},d(m){m&&(se(t),se(n)),X(e,m),X(i),l[31](null),X(c),~_&&M[_].d(),v&&v.d(),l[44](null)}}}function Yn(l,e,t){let n,{$$slots:i={},$$scope:s}=e,{value:r=null}=e,{label:c=void 0}=e,{show_label:o}=e,{sources:u=["upload","clipboard","webcam"]}=e,{streaming:f=!1}=e,{pending:_=!1}=e,{webcam_options:w}=e,{selectable:I=!1}=e,{root:R}=e,{i18n:g}=e,{max_file_size:p=null}=e,{upload:b}=e,{stream_handler:k}=e,{stream_every:F}=e,{modify_stream:M}=e,{set_time_limit:O}=e,{show_fullscreen_button:v=!0}=e,m,{uploading:h=!1}=e,{active_source:A=null}=e;async function j({detail:a}){if(!f){if(a.path?.toLowerCase().endsWith(".svg")&&a.url){const Re=await(await fetch(a.url)).text();t(3,r={...a,url:`data:image/svg+xml,${encodeURIComponent(Re)}`})}else t(3,r=a);N("upload")}}function E(){t(3,r=null),N("clear"),N("change",null)}async function T(a,ie){if(ie==="stream"){N("stream",{value:{url:a},is_value_data:!0});return}t(28,_=!0);const Re=await m.load_files([new File([a],`image/${f?"jpeg":"png"}`)]);(ie==="change"||ie==="upload")&&(t(3,r=Re?.[0]||null),await Vn(),N("change")),t(28,_=!1)}const N=Pn();let{dragging:G=!1}=e;function Se(a){let ie=wt(a);ie&&N("select",{index:ie,value:null})}async function ae(a){switch(a){case"clipboard":m.paste_clipboard();break}}let te;const ne=a=>{t(3,r=null),N("clear"),a.stopPropagation()};function De(a){le[a?"unshift":"push"](()=>{m=a,t(20,m)})}function qe(a){h=a,t(0,h)}function $e(a){G=a,t(2,G)}function Ee(a){ye.call(this,l,a)}function We(a){M=a,t(4,M)}function Be(a){O=a,t(5,O)}const d=a=>T(a.detail,"change"),q=a=>T(a.detail,"stream");function J(a){ye.call(this,l,a)}function ce(a){ye.call(this,l,a)}const ue=a=>T(a.detail,"upload");function Me(a){ye.call(this,l,a)}function at(a){A=a,t(1,A),t(8,u)}function ct(a){le[a?"unshift":"push"](()=>{te=a,t(21,te)})}return l.$$set=a=>{"value"in a&&t(3,r=a.value),"label"in a&&t(6,c=a.label),"show_label"in a&&t(7,o=a.show_label),"sources"in a&&t(8,u=a.sources),"streaming"in a&&t(9,f=a.streaming),"pending"in a&&t(28,_=a.pending),"webcam_options"in a&&t(10,w=a.webcam_options),"selectable"in a&&t(11,I=a.selectable),"root"in a&&t(12,R=a.root),"i18n"in a&&t(13,g=a.i18n),"max_file_size"in a&&t(14,p=a.max_file_size),"upload"in a&&t(15,b=a.upload),"stream_handler"in a&&t(16,k=a.stream_handler),"stream_every"in a&&t(17,F=a.stream_every),"modify_stream"in a&&t(4,M=a.modify_stream),"set_time_limit"in a&&t(5,O=a.set_time_limit),"show_fullscreen_button"in a&&t(18,v=a.show_fullscreen_button),"uploading"in a&&t(0,h=a.uploading),"active_source"in a&&t(1,A=a.active_source),"dragging"in a&&t(2,G=a.dragging),"$$scope"in a&&t(45,s=a.$$scope)},l.$$.update=()=>{l.$$.dirty[0]&258&&!A&&u&&t(1,A=u[0]),l.$$.dirty[0]&514&&t(19,n=f&&A==="webcam"),l.$$.dirty[0]&524289&&h&&!n&&t(3,r=null),l.$$.dirty[0]&4&&N("drag",G)},[h,A,G,r,M,O,c,o,u,f,w,I,R,g,p,b,k,F,v,n,m,te,j,E,T,N,Se,ae,_,i,ne,De,qe,$e,Ee,We,Be,d,q,J,ce,ue,Me,at,ct,s]}class Zn extends jn{constructor(e){super(),Fn(this,e,Yn,Xn,Hn,{value:3,label:6,show_label:7,sources:8,streaming:9,pending:28,webcam_options:10,selectable:11,root:12,i18n:13,max_file_size:14,upload:15,stream_handler:16,stream_every:17,modify_stream:4,set_time_limit:5,show_fullscreen_button:18,uploading:0,active_source:1,dragging:2},null,[-1,-1])}get value(){return this.$$.ctx[3]}set value(e){this.$$set({value:e}),S()}get label(){return this.$$.ctx[6]}set label(e){this.$$set({label:e}),S()}get show_label(){return this.$$.ctx[7]}set show_label(e){this.$$set({show_label:e}),S()}get sources(){return this.$$.ctx[8]}set sources(e){this.$$set({sources:e}),S()}get streaming(){return this.$$.ctx[9]}set streaming(e){this.$$set({streaming:e}),S()}get pending(){return this.$$.ctx[28]}set pending(e){this.$$set({pending:e}),S()}get webcam_options(){return this.$$.ctx[10]}set webcam_options(e){this.$$set({webcam_options:e}),S()}get selectable(){return this.$$.ctx[11]}set selectable(e){this.$$set({selectable:e}),S()}get root(){return this.$$.ctx[12]}set root(e){this.$$set({root:e}),S()}get i18n(){return this.$$.ctx[13]}set i18n(e){this.$$set({i18n:e}),S()}get max_file_size(){return this.$$.ctx[14]}set max_file_size(e){this.$$set({max_file_size:e}),S()}get upload(){return this.$$.ctx[15]}set upload(e){this.$$set({upload:e}),S()}get stream_handler(){return this.$$.ctx[16]}set stream_handler(e){this.$$set({stream_handler:e}),S()}get stream_every(){return this.$$.ctx[17]}set stream_every(e){this.$$set({stream_every:e}),S()}get modify_stream(){return this.$$.ctx[4]}set modify_stream(e){this.$$set({modify_stream:e}),S()}get set_time_limit(){return this.$$.ctx[5]}set set_time_limit(e){this.$$set({set_time_limit:e}),S()}get show_fullscreen_button(){return this.$$.ctx[18]}set show_fullscreen_button(e){this.$$set({show_fullscreen_button:e}),S()}get uploading(){return this.$$.ctx[0]}set uploading(e){this.$$set({uploading:e}),S()}get active_source(){return this.$$.ctx[1]}set active_source(e){this.$$set({active_source:e}),S()}get dragging(){return this.$$.ctx[2]}set dragging(e){this.$$set({dragging:e}),S()}}const pi=Zn;export{Ft as C,pi as I,Tn as W};
//# sourceMappingURL=ImageUploader-t0JnE6I4.js.map
