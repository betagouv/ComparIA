# Local PostgreSQL container with production data restore
# Place your backup.dump file in ./data/ before running
# Usage: docker compose -f prd-db-local.compose.yml up
services:
  postgres-prd:
    image: postgres:16
    container_name: comparia-prd-db-local
    environment:
      POSTGRES_USER: postgres
      POSTGRES_PASSWORD: postgres
      POSTGRES_DB: languia
    volumes:
      - prd-db-data:/var/lib/postgresql/data
      - ./prd-backup.dump:/backup/backup.dump:ro
      - ./restore-backup.sh:/docker-entrypoint-initdb.d/restore-backup.sh:ro
    ports:
      - "127.0.0.1:5433:5432"
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U postgres"]
      interval: 5s
      timeout: 5s
      retries: 5
    networks:
      - comparia-local-db-prd

networks:
  comparia-local-db-prd:

volumes:
  prd-db-data:
